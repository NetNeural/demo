revoke delete on table "public"."alerts" from "anon";

revoke insert on table "public"."alerts" from "anon";

revoke references on table "public"."alerts" from "anon";

revoke select on table "public"."alerts" from "anon";

revoke trigger on table "public"."alerts" from "anon";

revoke truncate on table "public"."alerts" from "anon";

revoke update on table "public"."alerts" from "anon";

revoke delete on table "public"."alerts" from "authenticated";

revoke insert on table "public"."alerts" from "authenticated";

revoke references on table "public"."alerts" from "authenticated";

revoke select on table "public"."alerts" from "authenticated";

revoke trigger on table "public"."alerts" from "authenticated";

revoke truncate on table "public"."alerts" from "authenticated";

revoke update on table "public"."alerts" from "authenticated";

revoke delete on table "public"."alerts" from "service_role";

revoke insert on table "public"."alerts" from "service_role";

revoke references on table "public"."alerts" from "service_role";

revoke select on table "public"."alerts" from "service_role";

revoke trigger on table "public"."alerts" from "service_role";

revoke truncate on table "public"."alerts" from "service_role";

revoke update on table "public"."alerts" from "service_role";

revoke delete on table "public"."audit_logs" from "anon";

revoke insert on table "public"."audit_logs" from "anon";

revoke references on table "public"."audit_logs" from "anon";

revoke select on table "public"."audit_logs" from "anon";

revoke trigger on table "public"."audit_logs" from "anon";

revoke truncate on table "public"."audit_logs" from "anon";

revoke update on table "public"."audit_logs" from "anon";

revoke delete on table "public"."audit_logs" from "authenticated";

revoke insert on table "public"."audit_logs" from "authenticated";

revoke references on table "public"."audit_logs" from "authenticated";

revoke select on table "public"."audit_logs" from "authenticated";

revoke trigger on table "public"."audit_logs" from "authenticated";

revoke truncate on table "public"."audit_logs" from "authenticated";

revoke update on table "public"."audit_logs" from "authenticated";

revoke delete on table "public"."audit_logs" from "service_role";

revoke insert on table "public"."audit_logs" from "service_role";

revoke references on table "public"."audit_logs" from "service_role";

revoke select on table "public"."audit_logs" from "service_role";

revoke trigger on table "public"."audit_logs" from "service_role";

revoke truncate on table "public"."audit_logs" from "service_role";

revoke update on table "public"."audit_logs" from "service_role";

revoke delete on table "public"."departments" from "anon";

revoke insert on table "public"."departments" from "anon";

revoke references on table "public"."departments" from "anon";

revoke select on table "public"."departments" from "anon";

revoke trigger on table "public"."departments" from "anon";

revoke truncate on table "public"."departments" from "anon";

revoke update on table "public"."departments" from "anon";

revoke delete on table "public"."departments" from "authenticated";

revoke insert on table "public"."departments" from "authenticated";

revoke references on table "public"."departments" from "authenticated";

revoke select on table "public"."departments" from "authenticated";

revoke trigger on table "public"."departments" from "authenticated";

revoke truncate on table "public"."departments" from "authenticated";

revoke update on table "public"."departments" from "authenticated";

revoke delete on table "public"."departments" from "service_role";

revoke insert on table "public"."departments" from "service_role";

revoke references on table "public"."departments" from "service_role";

revoke select on table "public"."departments" from "service_role";

revoke trigger on table "public"."departments" from "service_role";

revoke truncate on table "public"."departments" from "service_role";

revoke update on table "public"."departments" from "service_role";

revoke delete on table "public"."device_conflicts" from "anon";

revoke insert on table "public"."device_conflicts" from "anon";

revoke references on table "public"."device_conflicts" from "anon";

revoke select on table "public"."device_conflicts" from "anon";

revoke trigger on table "public"."device_conflicts" from "anon";

revoke truncate on table "public"."device_conflicts" from "anon";

revoke update on table "public"."device_conflicts" from "anon";

revoke delete on table "public"."device_conflicts" from "authenticated";

revoke insert on table "public"."device_conflicts" from "authenticated";

revoke references on table "public"."device_conflicts" from "authenticated";

revoke select on table "public"."device_conflicts" from "authenticated";

revoke trigger on table "public"."device_conflicts" from "authenticated";

revoke truncate on table "public"."device_conflicts" from "authenticated";

revoke update on table "public"."device_conflicts" from "authenticated";

revoke delete on table "public"."device_conflicts" from "service_role";

revoke insert on table "public"."device_conflicts" from "service_role";

revoke references on table "public"."device_conflicts" from "service_role";

revoke select on table "public"."device_conflicts" from "service_role";

revoke trigger on table "public"."device_conflicts" from "service_role";

revoke truncate on table "public"."device_conflicts" from "service_role";

revoke update on table "public"."device_conflicts" from "service_role";

revoke delete on table "public"."device_data" from "anon";

revoke insert on table "public"."device_data" from "anon";

revoke references on table "public"."device_data" from "anon";

revoke select on table "public"."device_data" from "anon";

revoke trigger on table "public"."device_data" from "anon";

revoke truncate on table "public"."device_data" from "anon";

revoke update on table "public"."device_data" from "anon";

revoke delete on table "public"."device_data" from "authenticated";

revoke insert on table "public"."device_data" from "authenticated";

revoke references on table "public"."device_data" from "authenticated";

revoke select on table "public"."device_data" from "authenticated";

revoke trigger on table "public"."device_data" from "authenticated";

revoke truncate on table "public"."device_data" from "authenticated";

revoke update on table "public"."device_data" from "authenticated";

revoke delete on table "public"."device_data" from "service_role";

revoke insert on table "public"."device_data" from "service_role";

revoke references on table "public"."device_data" from "service_role";

revoke select on table "public"."device_data" from "service_role";

revoke trigger on table "public"."device_data" from "service_role";

revoke truncate on table "public"."device_data" from "service_role";

revoke update on table "public"."device_data" from "service_role";

revoke delete on table "public"."device_integrations" from "anon";

revoke insert on table "public"."device_integrations" from "anon";

revoke references on table "public"."device_integrations" from "anon";

revoke select on table "public"."device_integrations" from "anon";

revoke trigger on table "public"."device_integrations" from "anon";

revoke truncate on table "public"."device_integrations" from "anon";

revoke update on table "public"."device_integrations" from "anon";

revoke delete on table "public"."device_integrations" from "authenticated";

revoke insert on table "public"."device_integrations" from "authenticated";

revoke references on table "public"."device_integrations" from "authenticated";

revoke select on table "public"."device_integrations" from "authenticated";

revoke trigger on table "public"."device_integrations" from "authenticated";

revoke truncate on table "public"."device_integrations" from "authenticated";

revoke update on table "public"."device_integrations" from "authenticated";

revoke delete on table "public"."device_integrations" from "service_role";

revoke insert on table "public"."device_integrations" from "service_role";

revoke references on table "public"."device_integrations" from "service_role";

revoke select on table "public"."device_integrations" from "service_role";

revoke trigger on table "public"."device_integrations" from "service_role";

revoke truncate on table "public"."device_integrations" from "service_role";

revoke update on table "public"."device_integrations" from "service_role";

revoke delete on table "public"."device_service_assignments" from "anon";

revoke insert on table "public"."device_service_assignments" from "anon";

revoke references on table "public"."device_service_assignments" from "anon";

revoke select on table "public"."device_service_assignments" from "anon";

revoke trigger on table "public"."device_service_assignments" from "anon";

revoke truncate on table "public"."device_service_assignments" from "anon";

revoke update on table "public"."device_service_assignments" from "anon";

revoke delete on table "public"."device_service_assignments" from "authenticated";

revoke insert on table "public"."device_service_assignments" from "authenticated";

revoke references on table "public"."device_service_assignments" from "authenticated";

revoke select on table "public"."device_service_assignments" from "authenticated";

revoke trigger on table "public"."device_service_assignments" from "authenticated";

revoke truncate on table "public"."device_service_assignments" from "authenticated";

revoke update on table "public"."device_service_assignments" from "authenticated";

revoke delete on table "public"."device_service_assignments" from "service_role";

revoke insert on table "public"."device_service_assignments" from "service_role";

revoke references on table "public"."device_service_assignments" from "service_role";

revoke select on table "public"."device_service_assignments" from "service_role";

revoke trigger on table "public"."device_service_assignments" from "service_role";

revoke truncate on table "public"."device_service_assignments" from "service_role";

revoke update on table "public"."device_service_assignments" from "service_role";

revoke delete on table "public"."devices" from "anon";

revoke insert on table "public"."devices" from "anon";

revoke references on table "public"."devices" from "anon";

revoke select on table "public"."devices" from "anon";

revoke trigger on table "public"."devices" from "anon";

revoke truncate on table "public"."devices" from "anon";

revoke update on table "public"."devices" from "anon";

revoke delete on table "public"."devices" from "authenticated";

revoke insert on table "public"."devices" from "authenticated";

revoke references on table "public"."devices" from "authenticated";

revoke select on table "public"."devices" from "authenticated";

revoke trigger on table "public"."devices" from "authenticated";

revoke truncate on table "public"."devices" from "authenticated";

revoke update on table "public"."devices" from "authenticated";

revoke delete on table "public"."devices" from "service_role";

revoke insert on table "public"."devices" from "service_role";

revoke references on table "public"."devices" from "service_role";

revoke select on table "public"."devices" from "service_role";

revoke trigger on table "public"."devices" from "service_role";

revoke truncate on table "public"."devices" from "service_role";

revoke update on table "public"."devices" from "service_role";

revoke delete on table "public"."golioth_sync_log" from "anon";

revoke insert on table "public"."golioth_sync_log" from "anon";

revoke references on table "public"."golioth_sync_log" from "anon";

revoke select on table "public"."golioth_sync_log" from "anon";

revoke trigger on table "public"."golioth_sync_log" from "anon";

revoke truncate on table "public"."golioth_sync_log" from "anon";

revoke update on table "public"."golioth_sync_log" from "anon";

revoke delete on table "public"."golioth_sync_log" from "authenticated";

revoke insert on table "public"."golioth_sync_log" from "authenticated";

revoke references on table "public"."golioth_sync_log" from "authenticated";

revoke select on table "public"."golioth_sync_log" from "authenticated";

revoke trigger on table "public"."golioth_sync_log" from "authenticated";

revoke truncate on table "public"."golioth_sync_log" from "authenticated";

revoke update on table "public"."golioth_sync_log" from "authenticated";

revoke delete on table "public"."golioth_sync_log" from "service_role";

revoke insert on table "public"."golioth_sync_log" from "service_role";

revoke references on table "public"."golioth_sync_log" from "service_role";

revoke select on table "public"."golioth_sync_log" from "service_role";

revoke trigger on table "public"."golioth_sync_log" from "service_role";

revoke truncate on table "public"."golioth_sync_log" from "service_role";

revoke update on table "public"."golioth_sync_log" from "service_role";

revoke delete on table "public"."golioth_sync_log_2025_10" from "anon";

revoke insert on table "public"."golioth_sync_log_2025_10" from "anon";

revoke references on table "public"."golioth_sync_log_2025_10" from "anon";

revoke select on table "public"."golioth_sync_log_2025_10" from "anon";

revoke trigger on table "public"."golioth_sync_log_2025_10" from "anon";

revoke truncate on table "public"."golioth_sync_log_2025_10" from "anon";

revoke update on table "public"."golioth_sync_log_2025_10" from "anon";

revoke delete on table "public"."golioth_sync_log_2025_10" from "authenticated";

revoke insert on table "public"."golioth_sync_log_2025_10" from "authenticated";

revoke references on table "public"."golioth_sync_log_2025_10" from "authenticated";

revoke select on table "public"."golioth_sync_log_2025_10" from "authenticated";

revoke trigger on table "public"."golioth_sync_log_2025_10" from "authenticated";

revoke truncate on table "public"."golioth_sync_log_2025_10" from "authenticated";

revoke update on table "public"."golioth_sync_log_2025_10" from "authenticated";

revoke delete on table "public"."golioth_sync_log_2025_10" from "service_role";

revoke insert on table "public"."golioth_sync_log_2025_10" from "service_role";

revoke references on table "public"."golioth_sync_log_2025_10" from "service_role";

revoke select on table "public"."golioth_sync_log_2025_10" from "service_role";

revoke trigger on table "public"."golioth_sync_log_2025_10" from "service_role";

revoke truncate on table "public"."golioth_sync_log_2025_10" from "service_role";

revoke update on table "public"."golioth_sync_log_2025_10" from "service_role";

revoke delete on table "public"."golioth_sync_log_2025_11" from "anon";

revoke insert on table "public"."golioth_sync_log_2025_11" from "anon";

revoke references on table "public"."golioth_sync_log_2025_11" from "anon";

revoke select on table "public"."golioth_sync_log_2025_11" from "anon";

revoke trigger on table "public"."golioth_sync_log_2025_11" from "anon";

revoke truncate on table "public"."golioth_sync_log_2025_11" from "anon";

revoke update on table "public"."golioth_sync_log_2025_11" from "anon";

revoke delete on table "public"."golioth_sync_log_2025_11" from "authenticated";

revoke insert on table "public"."golioth_sync_log_2025_11" from "authenticated";

revoke references on table "public"."golioth_sync_log_2025_11" from "authenticated";

revoke select on table "public"."golioth_sync_log_2025_11" from "authenticated";

revoke trigger on table "public"."golioth_sync_log_2025_11" from "authenticated";

revoke truncate on table "public"."golioth_sync_log_2025_11" from "authenticated";

revoke update on table "public"."golioth_sync_log_2025_11" from "authenticated";

revoke delete on table "public"."golioth_sync_log_2025_11" from "service_role";

revoke insert on table "public"."golioth_sync_log_2025_11" from "service_role";

revoke references on table "public"."golioth_sync_log_2025_11" from "service_role";

revoke select on table "public"."golioth_sync_log_2025_11" from "service_role";

revoke trigger on table "public"."golioth_sync_log_2025_11" from "service_role";

revoke truncate on table "public"."golioth_sync_log_2025_11" from "service_role";

revoke update on table "public"."golioth_sync_log_2025_11" from "service_role";

revoke delete on table "public"."golioth_sync_log_2025_12" from "anon";

revoke insert on table "public"."golioth_sync_log_2025_12" from "anon";

revoke references on table "public"."golioth_sync_log_2025_12" from "anon";

revoke select on table "public"."golioth_sync_log_2025_12" from "anon";

revoke trigger on table "public"."golioth_sync_log_2025_12" from "anon";

revoke truncate on table "public"."golioth_sync_log_2025_12" from "anon";

revoke update on table "public"."golioth_sync_log_2025_12" from "anon";

revoke delete on table "public"."golioth_sync_log_2025_12" from "authenticated";

revoke insert on table "public"."golioth_sync_log_2025_12" from "authenticated";

revoke references on table "public"."golioth_sync_log_2025_12" from "authenticated";

revoke select on table "public"."golioth_sync_log_2025_12" from "authenticated";

revoke trigger on table "public"."golioth_sync_log_2025_12" from "authenticated";

revoke truncate on table "public"."golioth_sync_log_2025_12" from "authenticated";

revoke update on table "public"."golioth_sync_log_2025_12" from "authenticated";

revoke delete on table "public"."golioth_sync_log_2025_12" from "service_role";

revoke insert on table "public"."golioth_sync_log_2025_12" from "service_role";

revoke references on table "public"."golioth_sync_log_2025_12" from "service_role";

revoke select on table "public"."golioth_sync_log_2025_12" from "service_role";

revoke trigger on table "public"."golioth_sync_log_2025_12" from "service_role";

revoke truncate on table "public"."golioth_sync_log_2025_12" from "service_role";

revoke update on table "public"."golioth_sync_log_2025_12" from "service_role";

revoke delete on table "public"."golioth_sync_log_2026_01" from "anon";

revoke insert on table "public"."golioth_sync_log_2026_01" from "anon";

revoke references on table "public"."golioth_sync_log_2026_01" from "anon";

revoke select on table "public"."golioth_sync_log_2026_01" from "anon";

revoke trigger on table "public"."golioth_sync_log_2026_01" from "anon";

revoke truncate on table "public"."golioth_sync_log_2026_01" from "anon";

revoke update on table "public"."golioth_sync_log_2026_01" from "anon";

revoke delete on table "public"."golioth_sync_log_2026_01" from "authenticated";

revoke insert on table "public"."golioth_sync_log_2026_01" from "authenticated";

revoke references on table "public"."golioth_sync_log_2026_01" from "authenticated";

revoke select on table "public"."golioth_sync_log_2026_01" from "authenticated";

revoke trigger on table "public"."golioth_sync_log_2026_01" from "authenticated";

revoke truncate on table "public"."golioth_sync_log_2026_01" from "authenticated";

revoke update on table "public"."golioth_sync_log_2026_01" from "authenticated";

revoke delete on table "public"."golioth_sync_log_2026_01" from "service_role";

revoke insert on table "public"."golioth_sync_log_2026_01" from "service_role";

revoke references on table "public"."golioth_sync_log_2026_01" from "service_role";

revoke select on table "public"."golioth_sync_log_2026_01" from "service_role";

revoke trigger on table "public"."golioth_sync_log_2026_01" from "service_role";

revoke truncate on table "public"."golioth_sync_log_2026_01" from "service_role";

revoke update on table "public"."golioth_sync_log_2026_01" from "service_role";

revoke delete on table "public"."integration_activity_log" from "anon";

revoke insert on table "public"."integration_activity_log" from "anon";

revoke references on table "public"."integration_activity_log" from "anon";

revoke select on table "public"."integration_activity_log" from "anon";

revoke trigger on table "public"."integration_activity_log" from "anon";

revoke truncate on table "public"."integration_activity_log" from "anon";

revoke update on table "public"."integration_activity_log" from "anon";

revoke delete on table "public"."integration_activity_log" from "authenticated";

revoke insert on table "public"."integration_activity_log" from "authenticated";

revoke references on table "public"."integration_activity_log" from "authenticated";

revoke select on table "public"."integration_activity_log" from "authenticated";

revoke trigger on table "public"."integration_activity_log" from "authenticated";

revoke truncate on table "public"."integration_activity_log" from "authenticated";

revoke update on table "public"."integration_activity_log" from "authenticated";

revoke delete on table "public"."integration_activity_log" from "service_role";

revoke insert on table "public"."integration_activity_log" from "service_role";

revoke references on table "public"."integration_activity_log" from "service_role";

revoke select on table "public"."integration_activity_log" from "service_role";

revoke trigger on table "public"."integration_activity_log" from "service_role";

revoke truncate on table "public"."integration_activity_log" from "service_role";

revoke update on table "public"."integration_activity_log" from "service_role";

revoke delete on table "public"."locations" from "anon";

revoke insert on table "public"."locations" from "anon";

revoke references on table "public"."locations" from "anon";

revoke select on table "public"."locations" from "anon";

revoke trigger on table "public"."locations" from "anon";

revoke truncate on table "public"."locations" from "anon";

revoke update on table "public"."locations" from "anon";

revoke delete on table "public"."locations" from "authenticated";

revoke insert on table "public"."locations" from "authenticated";

revoke references on table "public"."locations" from "authenticated";

revoke select on table "public"."locations" from "authenticated";

revoke trigger on table "public"."locations" from "authenticated";

revoke truncate on table "public"."locations" from "authenticated";

revoke update on table "public"."locations" from "authenticated";

revoke delete on table "public"."locations" from "service_role";

revoke insert on table "public"."locations" from "service_role";

revoke references on table "public"."locations" from "service_role";

revoke select on table "public"."locations" from "service_role";

revoke trigger on table "public"."locations" from "service_role";

revoke truncate on table "public"."locations" from "service_role";

revoke update on table "public"."locations" from "service_role";

revoke delete on table "public"."mqtt_messages" from "anon";

revoke insert on table "public"."mqtt_messages" from "anon";

revoke references on table "public"."mqtt_messages" from "anon";

revoke select on table "public"."mqtt_messages" from "anon";

revoke trigger on table "public"."mqtt_messages" from "anon";

revoke truncate on table "public"."mqtt_messages" from "anon";

revoke update on table "public"."mqtt_messages" from "anon";

revoke delete on table "public"."mqtt_messages" from "authenticated";

revoke insert on table "public"."mqtt_messages" from "authenticated";

revoke references on table "public"."mqtt_messages" from "authenticated";

revoke select on table "public"."mqtt_messages" from "authenticated";

revoke trigger on table "public"."mqtt_messages" from "authenticated";

revoke truncate on table "public"."mqtt_messages" from "authenticated";

revoke update on table "public"."mqtt_messages" from "authenticated";

revoke delete on table "public"."mqtt_messages" from "service_role";

revoke insert on table "public"."mqtt_messages" from "service_role";

revoke references on table "public"."mqtt_messages" from "service_role";

revoke select on table "public"."mqtt_messages" from "service_role";

revoke trigger on table "public"."mqtt_messages" from "service_role";

revoke truncate on table "public"."mqtt_messages" from "service_role";

revoke update on table "public"."mqtt_messages" from "service_role";

revoke delete on table "public"."notification_log" from "anon";

revoke insert on table "public"."notification_log" from "anon";

revoke references on table "public"."notification_log" from "anon";

revoke select on table "public"."notification_log" from "anon";

revoke trigger on table "public"."notification_log" from "anon";

revoke truncate on table "public"."notification_log" from "anon";

revoke update on table "public"."notification_log" from "anon";

revoke delete on table "public"."notification_log" from "authenticated";

revoke insert on table "public"."notification_log" from "authenticated";

revoke references on table "public"."notification_log" from "authenticated";

revoke select on table "public"."notification_log" from "authenticated";

revoke trigger on table "public"."notification_log" from "authenticated";

revoke truncate on table "public"."notification_log" from "authenticated";

revoke update on table "public"."notification_log" from "authenticated";

revoke delete on table "public"."notification_log" from "service_role";

revoke insert on table "public"."notification_log" from "service_role";

revoke references on table "public"."notification_log" from "service_role";

revoke select on table "public"."notification_log" from "service_role";

revoke trigger on table "public"."notification_log" from "service_role";

revoke truncate on table "public"."notification_log" from "service_role";

revoke update on table "public"."notification_log" from "service_role";

revoke delete on table "public"."notifications" from "anon";

revoke insert on table "public"."notifications" from "anon";

revoke references on table "public"."notifications" from "anon";

revoke select on table "public"."notifications" from "anon";

revoke trigger on table "public"."notifications" from "anon";

revoke truncate on table "public"."notifications" from "anon";

revoke update on table "public"."notifications" from "anon";

revoke delete on table "public"."notifications" from "authenticated";

revoke insert on table "public"."notifications" from "authenticated";

revoke references on table "public"."notifications" from "authenticated";

revoke select on table "public"."notifications" from "authenticated";

revoke trigger on table "public"."notifications" from "authenticated";

revoke truncate on table "public"."notifications" from "authenticated";

revoke update on table "public"."notifications" from "authenticated";

revoke delete on table "public"."notifications" from "service_role";

revoke insert on table "public"."notifications" from "service_role";

revoke references on table "public"."notifications" from "service_role";

revoke select on table "public"."notifications" from "service_role";

revoke trigger on table "public"."notifications" from "service_role";

revoke truncate on table "public"."notifications" from "service_role";

revoke update on table "public"."notifications" from "service_role";

revoke delete on table "public"."organization_members" from "anon";

revoke insert on table "public"."organization_members" from "anon";

revoke references on table "public"."organization_members" from "anon";

revoke select on table "public"."organization_members" from "anon";

revoke trigger on table "public"."organization_members" from "anon";

revoke truncate on table "public"."organization_members" from "anon";

revoke update on table "public"."organization_members" from "anon";

revoke delete on table "public"."organization_members" from "authenticated";

revoke insert on table "public"."organization_members" from "authenticated";

revoke references on table "public"."organization_members" from "authenticated";

revoke select on table "public"."organization_members" from "authenticated";

revoke trigger on table "public"."organization_members" from "authenticated";

revoke truncate on table "public"."organization_members" from "authenticated";

revoke update on table "public"."organization_members" from "authenticated";

revoke delete on table "public"."organization_members" from "service_role";

revoke insert on table "public"."organization_members" from "service_role";

revoke references on table "public"."organization_members" from "service_role";

revoke select on table "public"."organization_members" from "service_role";

revoke trigger on table "public"."organization_members" from "service_role";

revoke truncate on table "public"."organization_members" from "service_role";

revoke update on table "public"."organization_members" from "service_role";

revoke delete on table "public"."organizations" from "anon";

revoke insert on table "public"."organizations" from "anon";

revoke references on table "public"."organizations" from "anon";

revoke select on table "public"."organizations" from "anon";

revoke trigger on table "public"."organizations" from "anon";

revoke truncate on table "public"."organizations" from "anon";

revoke update on table "public"."organizations" from "anon";

revoke delete on table "public"."organizations" from "authenticated";

revoke insert on table "public"."organizations" from "authenticated";

revoke references on table "public"."organizations" from "authenticated";

revoke select on table "public"."organizations" from "authenticated";

revoke trigger on table "public"."organizations" from "authenticated";

revoke truncate on table "public"."organizations" from "authenticated";

revoke update on table "public"."organizations" from "authenticated";

revoke delete on table "public"."organizations" from "service_role";

revoke insert on table "public"."organizations" from "service_role";

revoke references on table "public"."organizations" from "service_role";

revoke select on table "public"."organizations" from "service_role";

revoke trigger on table "public"."organizations" from "service_role";

revoke truncate on table "public"."organizations" from "service_role";

revoke update on table "public"."organizations" from "service_role";

revoke delete on table "public"."sync_queue" from "anon";

revoke insert on table "public"."sync_queue" from "anon";

revoke references on table "public"."sync_queue" from "anon";

revoke select on table "public"."sync_queue" from "anon";

revoke trigger on table "public"."sync_queue" from "anon";

revoke truncate on table "public"."sync_queue" from "anon";

revoke update on table "public"."sync_queue" from "anon";

revoke delete on table "public"."sync_queue" from "authenticated";

revoke insert on table "public"."sync_queue" from "authenticated";

revoke references on table "public"."sync_queue" from "authenticated";

revoke select on table "public"."sync_queue" from "authenticated";

revoke trigger on table "public"."sync_queue" from "authenticated";

revoke truncate on table "public"."sync_queue" from "authenticated";

revoke update on table "public"."sync_queue" from "authenticated";

revoke delete on table "public"."sync_queue" from "service_role";

revoke insert on table "public"."sync_queue" from "service_role";

revoke references on table "public"."sync_queue" from "service_role";

revoke select on table "public"."sync_queue" from "service_role";

revoke trigger on table "public"."sync_queue" from "service_role";

revoke truncate on table "public"."sync_queue" from "service_role";

revoke update on table "public"."sync_queue" from "service_role";

revoke delete on table "public"."users" from "anon";

revoke insert on table "public"."users" from "anon";

revoke references on table "public"."users" from "anon";

revoke select on table "public"."users" from "anon";

revoke trigger on table "public"."users" from "anon";

revoke truncate on table "public"."users" from "anon";

revoke update on table "public"."users" from "anon";

revoke delete on table "public"."users" from "authenticated";

revoke insert on table "public"."users" from "authenticated";

revoke references on table "public"."users" from "authenticated";

revoke select on table "public"."users" from "authenticated";

revoke trigger on table "public"."users" from "authenticated";

revoke truncate on table "public"."users" from "authenticated";

revoke update on table "public"."users" from "authenticated";

revoke delete on table "public"."users" from "service_role";

revoke insert on table "public"."users" from "service_role";

revoke references on table "public"."users" from "service_role";

revoke select on table "public"."users" from "service_role";

revoke trigger on table "public"."users" from "service_role";

revoke truncate on table "public"."users" from "service_role";

revoke update on table "public"."users" from "service_role";

alter table "public"."device_integrations" drop constraint "device_integrations_integration_type_check";

alter table "public"."device_integrations" add constraint "device_integrations_integration_type_check" CHECK (((integration_type)::text = ANY ((ARRAY['golioth'::character varying, 'aws_iot'::character varying, 'azure_iot'::character varying, 'google_iot'::character varying])::text[]))) not valid;

alter table "public"."device_integrations" validate constraint "device_integrations_integration_type_check";

set check_function_bodies = off;

CREATE OR REPLACE FUNCTION public.gen_random_uuid()
 RETURNS uuid
 LANGUAGE sql
 IMMUTABLE
AS $function$
  SELECT gen_random_uuid();
$function$
;

CREATE OR REPLACE FUNCTION public.cleanup_old_integration_logs()
 RETURNS integer
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    deleted_count INTEGER;
BEGIN
    DELETE FROM integration_activity_log
    WHERE created_at < NOW() - INTERVAL '90 days'
    RETURNING COUNT(*) INTO deleted_count;
    
    RETURN deleted_count;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.complete_integration_activity(p_log_id uuid, p_status character varying, p_response_status integer DEFAULT NULL::integer, p_response_body jsonb DEFAULT NULL::jsonb, p_response_time_ms integer DEFAULT NULL::integer, p_error_message text DEFAULT NULL::text, p_error_code character varying DEFAULT NULL::character varying)
 RETURNS void
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
    UPDATE integration_activity_log
    SET 
        status = p_status,
        response_status = p_response_status,
        response_body = p_response_body,
        response_time_ms = p_response_time_ms,
        error_message = p_error_message,
        error_code = p_error_code,
        completed_at = NOW()
    WHERE id = p_log_id;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.get_pending_conflicts(org_id uuid)
 RETURNS TABLE(conflict_id uuid, device_id uuid, device_name character varying, conflict_type character varying, field_name character varying, created_at timestamp with time zone)
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
    RETURN QUERY
    SELECT 
        dc.id,
        dc.device_id,
        d.name,
        dc.conflict_type,
        dc.field_name,
        dc.created_at
    FROM device_conflicts dc
    INNER JOIN devices d ON dc.device_id = d.id
    WHERE d.organization_id = org_id
    AND dc.resolution_status = 'pending'
    ORDER BY dc.created_at ASC;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.get_sync_stats(org_id uuid, integration_id_param uuid DEFAULT NULL::uuid)
 RETURNS TABLE(total_syncs bigint, successful_syncs bigint, failed_syncs bigint, pending_conflicts bigint, last_sync_at timestamp with time zone, avg_duration_ms numeric)
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
    RETURN QUERY
    SELECT 
        COUNT(*)::BIGINT as total_syncs,
        COUNT(*) FILTER (WHERE status = 'completed')::BIGINT as successful_syncs,
        COUNT(*) FILTER (WHERE status = 'failed')::BIGINT as failed_syncs,
        (SELECT COUNT(*)::BIGINT FROM device_conflicts dc 
         INNER JOIN devices d ON dc.device_id = d.id 
         WHERE d.organization_id = org_id 
         AND dc.resolution_status = 'pending') as pending_conflicts,
        MAX(completed_at) as last_sync_at,
        AVG(duration_ms)::NUMERIC as avg_duration_ms
    FROM golioth_sync_log
    WHERE organization_id = org_id
    AND (integration_id_param IS NULL OR integration_id = integration_id_param)
    AND created_at > NOW() - INTERVAL '30 days';
END;
$function$
;

CREATE OR REPLACE FUNCTION public.get_user_organization_id()
 RETURNS uuid
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
    RETURN (
        SELECT organization_id 
        FROM users 
        WHERE id = auth.uid()
    );
END;
$function$
;

CREATE OR REPLACE FUNCTION public.get_user_role()
 RETURNS user_role
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
    RETURN (
        SELECT role 
        FROM users 
        WHERE id = auth.uid()
    );
END;
$function$
;

CREATE OR REPLACE FUNCTION public.log_integration_activity(p_organization_id uuid, p_integration_id uuid, p_direction character varying, p_activity_type character varying, p_method character varying DEFAULT NULL::character varying, p_endpoint text DEFAULT NULL::text, p_status character varying DEFAULT 'started'::character varying, p_user_id uuid DEFAULT NULL::uuid, p_metadata jsonb DEFAULT '{}'::jsonb)
 RETURNS uuid
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    v_log_id UUID;
BEGIN
    INSERT INTO integration_activity_log (
        organization_id,
        integration_id,
        direction,
        activity_type,
        method,
        endpoint,
        status,
        user_id,
        metadata
    ) VALUES (
        p_organization_id,
        p_integration_id,
        p_direction,
        p_activity_type,
        p_method,
        p_endpoint,
        p_status,
        p_user_id,
        p_metadata
    ) RETURNING id INTO v_log_id;
    
    RETURN v_log_id;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_device_integrations_updated_at()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_updated_at_column()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    NEW.updated_at = NOW();
    RETURN NEW;
END;
$function$
;



  create policy "Avatar images are publicly accessible"
  on "storage"."objects"
  as permissive
  for select
  to public
using ((bucket_id = 'avatars'::text));



  create policy "Users can update their own avatar"
  on "storage"."objects"
  as permissive
  for update
  to public
using (((bucket_id = 'avatars'::text) AND ((auth.uid())::text = (storage.foldername(name))[1])));



  create policy "Users can upload their own avatar"
  on "storage"."objects"
  as permissive
  for insert
  to public
with check (((bucket_id = 'avatars'::text) AND ((auth.uid())::text = (storage.foldername(name))[1])));



